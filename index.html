<!DOCTYPE html>
<html lang="zh-Hans">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./style.css">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>键盘导航</title>
</head>

<body>
  <main>
    <div class="wrapper" id="main"></div>
  </main>
</body>
<script>
  var keys = {
    '0': ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0'],
    '1': ['q', 'w', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p'],
    '2': ['a', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l'],
    '3': ['z', 'x', 'c', 'v', 'b', 'n', 'm'],
    'length': 4
  }
  var hash = {
    a: "apple.com",
    b: "bilibili.com",
    c: "csdn.net",
    d: "dangdang.com",
    e: "ele.me",
    f: "facebook.com",
    g: "google.com",
    h: "huawei.com",
    i: "iqiyi.com",
    j: "www.jd.com",
    k: "www.kugou.com",
    l: "lpl.qq.com",
    m: "www.mcdonalds.com.cn",
    n: "hs.blizzard.cn",
    o: "opera.com",
    p: "pinduoduo.com",
    q: "www.qq.com",
    r: "yyets.com",
    s: "sogou.com",
    t: "taobao.com",
    u: "ucweb.com",
    v: "v2ex.com",
    w: "weibo.com",
    x: "www.xiaomi.com",
    y: "youtube.com",
    z: "zhihu.com"
  }
  hashInLocalStorage = getData('zzz')
  if (hashInLocalStorage) {
    hash = hashInLocalStorage
  }

  function getData(name){
    return JSON.parse(localStorage.getItem('zzz') || 'null')
  }
  function tag(tagName) {
    return document.createElement(tagName)
  }
  for (var index = 0; index < keys['length']; index += 1) {
    div1 = tag('div')
    main.appendChild(div1)
    row = keys[index]
    for (index2 = 0; index2 < row['length']; index2 += 1) {
      kbd1 = tag('kbd')

      span1 = tag('span')
      span1.textContent = row[index2]
      span1.className = 'text'
      //上面三句话可简写为span1 = tag('span';{textContent:row[index2],className:'text'})遍历赋值 element本身就是hash
      button1 = tag('button')
      button1.textContent = '编辑'
      button1.id = row[index2]
      img = tag('img')
      if (hash[row[index2]]) {
        img.src = 'http://' + hash[row[index2]] + '/favicon.ico'
      } else {
        img.src = '//i.loli.net/2017/11/10/5a05afbc5e183.png'
      }
      img.onerror = function (xxx) {
        xxx.target.src = '//i.loli.net/2017/11/10/5a05afbc5e183.png'
      }

      button1.onclick = function (click) {
        key = click.target.id
        x = prompt('请输入需要跳转的网址')
        img2 = click.target.previousSibling.previousSibling
        hash[key] = x
        img2.src = 'http://' + x + '/favicon.ico'
        img2.onerror = function (xxx) {
          xxx.target.src = '//i.loli.net/2017/11/10/5a05afbc5e183.png'
        }
        localStorage.setItem('zzz', JSON.stringify(hash))
      }
      kbd1.appendChild(img)
      kbd1.appendChild(span1)
      kbd1.appendChild(button1)
      div1.appendChild(kbd1)
    }
  }
  document.onkeypress = function (click) {
    x = click['key']
    website = hash[x]
    if (website === undefined || null) {
      alert('请设置正确的网址')
    } else {
      window.open('http://' + website, '_blank')
    }
  }
</script>

</html>